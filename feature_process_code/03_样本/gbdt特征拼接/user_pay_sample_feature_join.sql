--odps sql
--********************************************************************--
--author:xufeng_17
--create time:2024-04-20 21:24:04
--********************************************************************--
create table if not exists user_pay_sample_feature_join (
    user_id string,
    brand_id string,
    label bigint,
    bizdate string,
    rnd double,

    click_item_num_3d BIGINT,
    click_brand_num_3d BIGINT,
    click_seller_num_3d BIGINT,
    click_cate1_num_3d BIGINT,
    click_cate2_num_3d BIGINT,
    click_cnt_days_3d BIGINT,
    click_item_num_7d BIGINT,
    click_brand_num_7d BIGINT,
    click_seller_num_7d BIGINT,
    click_cate1_num_7d BIGINT,
    click_cate2_num_7d BIGINT,
    click_cnt_days_7d BIGINT,
    click_item_num_15d BIGINT,
    click_brand_num_15d BIGINT,
    click_seller_num_15d BIGINT,
    click_cate1_num_15d BIGINT,
    click_cate2_num_15d BIGINT,
    click_cnt_days_15d BIGINT,
    click_item_num_30d BIGINT,
    click_brand_num_30d BIGINT,
    click_seller_num_30d BIGINT,
    click_cate1_num_30d BIGINT,
    click_cate2_num_30d BIGINT,
    click_cnt_days_30d BIGINT,
    click_item_num_60d BIGINT,
    click_brand_num_60d BIGINT,
    click_seller_num_60d BIGINT,
    click_cate1_num_60d BIGINT,
    click_cate2_num_60d BIGINT,
    click_cnt_days_60d BIGINT,
    click_item_num_90d BIGINT,
    click_brand_num_90d BIGINT,
    click_seller_num_90d BIGINT,
    click_cate1_num_90d BIGINT,
    click_cate2_num_90d BIGINT,
    click_cnt_days_90d BIGINT,

    clt_item_num_3d BIGINT,
    clt_brand_num_3d BIGINT,
    clt_seller_num_3d BIGINT,
    clt_cate1_num_3d BIGINT,
    clt_cate2_num_3d BIGINT,
    clt_item_num_7d BIGINT,
    clt_brand_num_7d BIGINT,
    clt_seller_num_7d BIGINT,
    clt_cate1_num_7d BIGINT,
    clt_cate2_num_7d BIGINT,
    clt_item_num_15d BIGINT,
    clt_brand_num_15d BIGINT,
    clt_seller_num_15d BIGINT,
    clt_cate1_num_15d BIGINT,
    clt_cate2_num_15d BIGINT,

    clt_item_num_30d BIGINT,
    clt_brand_num_30d BIGINT,
    clt_seller_num_30d BIGINT,
    clt_cate1_num_30d BIGINT,
    clt_cate2_num_30d BIGINT,

    clt_item_num_60d BIGINT,
    clt_brand_num_60d BIGINT,
    clt_seller_num_60d BIGINT,
    clt_cate1_num_60d BIGINT,
    clt_cate2_num_60d BIGINT,

    clt_item_num_90d BIGINT,
    clt_brand_num_90d BIGINT,
    clt_seller_num_90d BIGINT,
    clt_cate1_num_90d BIGINT,
    clt_cate2_num_90d BIGINT,

    cart_item_num_3d BIGINT,
    cart_brand_num_3d BIGINT,
    cart_seller_num_3d BIGINT,
    cart_cate1_num_3d BIGINT,
    cart_cate2_num_3d BIGINT,
    cart_item_num_7d BIGINT,
    cart_brand_num_7d BIGINT,
    cart_seller_num_7d BIGINT,
    cart_cate1_num_7d BIGINT,
    cart_cate2_num_7d BIGINT,
    cart_item_num_15d BIGINT,
    cart_brand_num_15d BIGINT,
    cart_seller_num_15d BIGINT,
    cart_cate1_num_15d BIGINT,
    cart_cate2_num_15d BIGINT,

    cart_item_num_30d BIGINT,
    cart_brand_num_30d BIGINT,
    cart_seller_num_30d BIGINT,
    cart_cate1_num_30d BIGINT,
    cart_cate2_num_30d BIGINT,

    cart_item_num_60d BIGINT,
    cart_brand_num_60d BIGINT,
    cart_seller_num_60d BIGINT,
    cart_cate1_num_60d BIGINT,
    cart_cate2_num_60d BIGINT,

    cart_item_num_90d BIGINT,
    cart_brand_num_90d BIGINT,
    cart_seller_num_90d BIGINT,
    cart_cate1_num_90d BIGINT,
    cart_cate2_num_90d BIGINT,

    pay_item_num_3d BIGINT,
    pay_brand_num_3d BIGINT,
    pay_seller_num_3d BIGINT,
    pay_cate1_num_3d BIGINT,
    pay_cate2_num_3d BIGINT,
    pay_item_num_7d BIGINT,
    pay_brand_num_7d BIGINT,
    pay_seller_num_7d BIGINT,
    pay_cate1_num_7d BIGINT,
    pay_cate2_num_7d BIGINT,
    pay_item_num_15d BIGINT,
    pay_brand_num_15d BIGINT,
    pay_seller_num_15d BIGINT,
    pay_cate1_num_15d BIGINT,
    pay_cate2_num_15d BIGINT,

    pay_item_num_30d BIGINT,
    pay_brand_num_30d BIGINT,
    pay_seller_num_30d BIGINT,
    pay_cate1_num_30d BIGINT,
    pay_cate2_num_30d BIGINT,

    pay_item_num_60d BIGINT,
    pay_brand_num_60d BIGINT,
    pay_seller_num_60d BIGINT,
    pay_cate1_num_60d BIGINT,
    pay_cate2_num_60d BIGINT,

    pay_item_num_90d BIGINT,
    pay_brand_num_90d BIGINT,
    pay_seller_num_90d BIGINT,
    pay_cate1_num_90d BIGINT,
    pay_cate2_num_90d BIGINT,

    brand_click_num bigint,
    brand_collect_num bigint,
    brand_cart_num bigint,
    brand_alipay_num bigint,

    cb_clk_item_90d bigint,
    cb_clk_item_60d bigint,
    cb_clk_item_30d bigint,
    cb_clk_item_15d bigint,
    cb_clk_item_7d bigint,
    cb_clk_item_3d bigint,
    cb_clk_item_1d bigint,
    cb_clk_num_90d bigint,
    cb_clk_num_60d bigint,
    cb_clk_num_30d bigint,
    cb_clk_num_15d bigint,
    cb_clk_num_7d bigint,
    cb_clk_num_3d bigint,
    cb_clk_num_1d bigint,
    cb_clk_day_90d bigint,
    cb_clk_day_60d bigint,
    cb_clk_day_30d bigint,
    cb_clk_day_15d bigint,
    cb_clk_day_7d bigint,
    cb_clk_day_3d bigint,
    cb_clk_day_1d bigint,
    cb_clt_item_90d bigint,
    cb_clt_item_60d bigint,
    cb_clt_item_30d bigint,
    cb_clt_item_15d bigint,
    cb_clt_item_7d bigint,
    cb_clt_item_3d bigint,
    cb_clt_item_1d bigint,
    cb_cart_item_90d bigint,
    cb_cart_item_60d bigint,
    cb_cart_item_30d bigint,
    cb_cart_item_15d bigint,
    cb_cart_item_7d bigint,
    cb_cart_item_3d bigint,
    cb_cart_item_1d bigint,
    cb_cart_num_90d bigint,
    cb_cart_num_60d bigint,
    cb_cart_num_30d bigint,
    cb_cart_num_15d bigint,
    cb_cart_num_7d bigint,
    cb_cart_num_3d bigint,
    cb_cart_num_1d bigint,
    cb_pay_item_90d bigint,
    cb_pay_item_60d bigint,
    cb_pay_item_30d bigint,
    cb_pay_item_15d bigint,
    cb_pay_item_7d bigint,
    cb_pay_item_3d bigint,
    cb_pay_item_1d bigint,
    cb_pay_num_90d bigint,
    cb_pay_num_60d bigint,
    cb_pay_num_30d bigint,
    cb_pay_num_15d bigint,
    cb_pay_num_7d bigint,
    cb_pay_num_3d bigint,
    cb_pay_num_1d bigint,

    -- c1_clk_item_90d bigint,
    -- c1_clk_item_60d bigint,
    -- c1_clk_item_30d bigint,
    -- c1_clk_item_15d bigint,
    -- c1_clk_item_7d bigint,
    -- c1_clk_item_3d bigint,
    -- c1_clk_item_1d bigint,
    -- c1_clk_num_90d bigint,
    -- c1_clk_num_60d bigint,
    -- c1_clk_num_30d bigint,
    -- c1_clk_num_15d bigint,
    -- c1_clk_num_7d bigint,
    -- c1_clk_num_3d bigint,
    -- c1_clk_num_1d bigint,
    -- c1_clk_day_90d bigint,
    -- c1_clk_day_60d bigint,
    -- c1_clk_day_30d bigint,
    -- c1_clk_day_15d bigint,
    -- c1_clk_day_7d bigint,
    -- c1_clk_day_3d bigint,
    -- c1_clk_day_1d bigint,
    -- c1_clt_item_90d bigint,
    -- c1_clt_item_60d bigint,
    -- c1_clt_item_30d bigint,
    -- c1_clt_item_15d bigint,
    -- c1_clt_item_7d bigint,
    -- c1_clt_item_3d bigint,
    -- c1_clt_item_1d bigint,
    -- c1_cart_item_90d bigint,
    -- c1_cart_item_60d bigint,
    -- c1_cart_item_30d bigint,
    -- c1_cart_item_15d bigint,
    -- c1_cart_item_7d bigint,
    -- c1_cart_item_3d bigint,
    -- c1_cart_item_1d bigint,
    -- c1_cart_num_90d bigint,
    -- c1_cart_num_60d bigint,
    -- c1_cart_num_30d bigint,
    -- c1_cart_num_15d bigint,
    -- c1_cart_num_7d bigint,
    -- c1_cart_num_3d bigint,
    -- c1_cart_num_1d bigint,
    -- c1_pay_item_90d bigint,
    -- c1_pay_item_60d bigint,
    -- c1_pay_item_30d bigint,
    -- c1_pay_item_15d bigint,
    -- c1_pay_item_7d bigint,
    -- c1_pay_item_3d bigint,
    -- c1_pay_item_1d bigint,
    -- c1_pay_num_90d bigint,
    -- c1_pay_num_60d bigint,
    -- c1_pay_num_30d bigint,
    -- c1_pay_num_15d bigint,
    -- c1_pay_num_7d bigint,
    -- c1_pay_num_3d bigint,
    -- c1_pay_num_1d bigint,

    c2_clk_item_90d bigint,
    c2_clk_item_60d bigint,
    c2_clk_item_30d bigint,
    c2_clk_item_15d bigint,
    c2_clk_item_7d bigint,
    c2_clk_item_3d bigint,
    c2_clk_item_1d bigint,
    c2_clk_num_90d bigint,
    c2_clk_num_60d bigint,
    c2_clk_num_30d bigint,
    c2_clk_num_15d bigint,
    c2_clk_num_7d bigint,
    c2_clk_num_3d bigint,
    c2_clk_num_1d bigint,
    c2_clk_day_90d bigint,
    c2_clk_day_60d bigint,
    c2_clk_day_30d bigint,
    c2_clk_day_15d bigint,
    c2_clk_day_7d bigint,
    c2_clk_day_3d bigint,
    c2_clk_day_1d bigint,
    c2_clt_item_90d bigint,
    c2_clt_item_60d bigint,
    c2_clt_item_30d bigint,
    c2_clt_item_15d bigint,
    c2_clt_item_7d bigint,
    c2_clt_item_3d bigint,
    c2_clt_item_1d bigint,
    c2_cart_item_90d bigint,
    c2_cart_item_60d bigint,
    c2_cart_item_30d bigint,
    c2_cart_item_15d bigint,
    c2_cart_item_7d bigint,
    c2_cart_item_3d bigint,
    c2_cart_item_1d bigint,
    c2_cart_num_90d bigint,
    c2_cart_num_60d bigint,
    c2_cart_num_30d bigint,
    c2_cart_num_15d bigint,
    c2_cart_num_7d bigint,
    c2_cart_num_3d bigint,
    c2_cart_num_1d bigint,
    c2_pay_item_90d bigint,
    c2_pay_item_60d bigint,
    c2_pay_item_30d bigint,
    c2_pay_item_15d bigint,
    c2_pay_item_7d bigint,
    c2_pay_item_3d bigint,
    c2_pay_item_1d bigint,
    c2_pay_num_90d bigint,
    c2_pay_num_60d bigint,
    c2_pay_num_30d bigint,
    c2_pay_num_15d bigint,
    c2_pay_num_7d bigint,
    c2_pay_num_3d bigint,
    c2_pay_num_1d bigint
)PARTITIONED by (ds string) LIFECYCLE 60;


insert OVERWRITE TABLE user_pay_sample_feature_join PARTITION (ds=${bizdate})
select t1.user_id, t1.brand_id, t1.label, t1.ds, RAND() as rnd,
    if(t2.item_num_3d is null, 0, t2.item_num_3d),
if(t2.brand_num_3d is null, 0, t2.brand_num_3d),
if(t2.seller_num_3d is null, 0, t2.seller_num_3d),
if(t2.cate1_num_3d is null, 0, t2.cate1_num_3d),
if(t2.cate2_num_3d is null, 0, t2.cate2_num_3d),
if(t2.cnt_days_3d is null, 0, t2.cnt_days_3d),
if(t2.item_num_7d is null, 0, t2.item_num_7d),
if(t2.brand_num_7d is null, 0, t2.brand_num_7d),
if(t2.seller_num_7d is null, 0, t2.seller_num_7d),
if(t2.cate1_num_7d is null, 0, t2.cate1_num_7d),
if(t2.cate2_num_7d is null, 0, t2.cate2_num_7d),
if(t2.cnt_days_7d is null, 0, t2.cnt_days_7d),
if(t2.item_num_15d is null, 0, t2.item_num_15d),
if(t2.brand_num_15d is null, 0, t2.brand_num_15d),
if(t2.seller_num_15d is null, 0, t2.seller_num_15d),
if(t2.cate1_num_15d is null, 0, t2.cate1_num_15d),
if(t2.cate2_num_15d is null, 0, t2.cate2_num_15d),
if(t2.cnt_days_15d is null, 0, t2.cnt_days_15d),
if(t2.item_num_30d is null, 0, t2.item_num_30d),
if(t2.brand_num_30d is null, 0, t2.brand_num_30d),
if(t2.seller_num_30d is null, 0, t2.seller_num_30d),
if(t2.cate1_num_30d is null, 0, t2.cate1_num_30d),
if(t2.cate2_num_30d is null, 0, t2.cate2_num_30d),
if(t2.cnt_days_30d is null, 0, t2.cnt_days_30d),
if(t2.item_num_60d is null, 0, t2.item_num_60d),
if(t2.brand_num_60d is null, 0, t2.brand_num_60d),
if(t2.seller_num_60d is null, 0, t2.seller_num_60d),
if(t2.cate1_num_60d is null, 0, t2.cate1_num_60d),
if(t2.cate2_num_60d is null, 0, t2.cate2_num_60d),
if(t2.cnt_days_60d is null, 0, t2.cnt_days_60d),
if(t2.item_num_90d is null, 0, t2.item_num_90d),
if(t2.brand_num_90d is null, 0, t2.brand_num_90d),
if(t2.seller_num_90d is null, 0, t2.seller_num_90d),
if(t2.cate1_num_90d is null, 0, t2.cate1_num_90d),
if(t2.cate2_num_90d is null, 0, t2.cate2_num_90d),
if(t2.cnt_days_90d is null, 0, t2.cnt_days_90d),

if(t3.item_num_3d is null, 0, t3.item_num_3d),
if(t3.brand_num_3d is null, 0, t3.brand_num_3d),
if(t3.seller_num_3d is null, 0, t3.seller_num_3d),
if(t3.cate1_num_3d is null, 0, t3.cate1_num_3d),
if(t3.cate2_num_3d is null, 0, t3.cate2_num_3d),
if(t3.item_num_7d is null, 0, t3.item_num_7d),
if(t3.brand_num_7d is null, 0, t3.brand_num_7d),
if(t3.seller_num_7d is null, 0, t3.seller_num_7d),
if(t3.cate1_num_7d is null, 0, t3.cate1_num_7d),
if(t3.cate2_num_7d is null, 0, t3.cate2_num_7d),
if(t3.item_num_15d is null, 0, t3.item_num_15d),
if(t3.brand_num_15d is null, 0, t3.brand_num_15d),
if(t3.seller_num_15d is null, 0, t3.seller_num_15d),
if(t3.cate1_num_15d is null, 0, t3.cate1_num_15d),
if(t3.cate2_num_15d is null, 0, t3.cate2_num_15d),

if(t3.item_num_30d is null, 0, t3.item_num_30d),
if(t3.brand_num_30d is null, 0, t3.brand_num_30d),
if(t3.seller_num_30d is null, 0, t3.seller_num_30d),
if(t3.cate1_num_30d is null, 0, t3.cate1_num_30d),
if(t3.cate2_num_30d is null, 0, t3.cate2_num_30d),

if(t3.item_num_60d is null, 0, t3.item_num_60d),
if(t3.brand_num_60d is null, 0, t3.brand_num_60d),
if(t3.seller_num_60d is null, 0, t3.seller_num_60d),
if(t3.cate1_num_60d is null, 0, t3.cate1_num_60d),
if(t3.cate2_num_60d is null, 0, t3.cate2_num_60d),

if(t3.item_num_90d is null, 0, t3.item_num_90d),
if(t3.brand_num_90d is null, 0, t3.brand_num_90d),
if(t3.seller_num_90d is null, 0, t3.seller_num_90d),
if(t3.cate1_num_90d is null, 0, t3.cate1_num_90d),
if(t3.cate2_num_90d is null, 0, t3.cate2_num_90d),

if(t4.item_num_3d is null, 0, t4.item_num_3d),
if(t4.brand_num_3d is null, 0, t4.brand_num_3d),
if(t4.seller_num_3d is null, 0, t4.seller_num_3d),
if(t4.cate1_num_3d is null, 0, t4.cate1_num_3d),
if(t4.cate2_num_3d is null, 0, t4.cate2_num_3d),
if(t4.item_num_7d is null, 0, t4.item_num_7d),
if(t4.brand_num_7d is null, 0, t4.brand_num_7d),
if(t4.seller_num_7d is null, 0, t4.seller_num_7d),
if(t4.cate1_num_7d is null, 0, t4.cate1_num_7d),
if(t4.cate2_num_7d is null, 0, t4.cate2_num_7d),
if(t4.item_num_15d is null, 0, t4.item_num_15d),
if(t4.brand_num_15d is null, 0, t4.brand_num_15d),
if(t4.seller_num_15d is null, 0, t4.seller_num_15d),
if(t4.cate1_num_15d is null, 0, t4.cate1_num_15d),
if(t4.cate2_num_15d is null, 0, t4.cate2_num_15d),

if(t4.item_num_30d is null, 0, t4.item_num_30d),
if(t4.brand_num_30d is null, 0, t4.brand_num_30d),
if(t4.seller_num_30d is null, 0, t4.seller_num_30d),
if(t4.cate1_num_30d is null, 0, t4.cate1_num_30d),
if(t4.cate2_num_30d is null, 0, t4.cate2_num_30d),

if(t4.item_num_60d is null, 0, t4.item_num_60d),
if(t4.brand_num_60d is null, 0, t4.brand_num_60d),
if(t4.seller_num_60d is null, 0, t4.seller_num_60d),
if(t4.cate1_num_60d is null, 0, t4.cate1_num_60d),
if(t4.cate2_num_60d is null, 0, t4.cate2_num_60d),

if(t4.item_num_90d is null, 0, t4.item_num_90d),
if(t4.brand_num_90d is null, 0, t4.brand_num_90d),
if(t4.seller_num_90d is null, 0, t4.seller_num_90d),
if(t4.cate1_num_90d is null, 0, t4.cate1_num_90d),
if(t4.cate2_num_90d is null, 0, t4.cate2_num_90d),

if(t5.item_num_3d is null, 0, t5.item_num_3d),
if(t5.brand_num_3d is null, 0, t5.brand_num_3d),
if(t5.seller_num_3d is null, 0, t5.seller_num_3d),
if(t5.cate1_num_3d is null, 0, t5.cate1_num_3d),
if(t5.cate2_num_3d is null, 0, t5.cate2_num_3d),
if(t5.item_num_7d is null, 0, t5.item_num_7d),
if(t5.brand_num_7d is null, 0, t5.brand_num_7d),
if(t5.seller_num_7d is null, 0, t5.seller_num_7d),
if(t5.cate1_num_7d is null, 0, t5.cate1_num_7d),
if(t5.cate2_num_7d is null, 0, t5.cate2_num_7d),
if(t5.item_num_15d is null, 0, t5.item_num_15d),
if(t5.brand_num_15d is null, 0, t5.brand_num_15d),
if(t5.seller_num_15d is null, 0, t5.seller_num_15d),
if(t5.cate1_num_15d is null, 0, t5.cate1_num_15d),
if(t5.cate2_num_15d is null, 0, t5.cate2_num_15d),
if(t5.item_num_30d is null, 0, t5.item_num_30d),
if(t5.brand_num_30d is null, 0, t5.brand_num_30d),
if(t5.seller_num_30d is null, 0, t5.seller_num_30d),
if(t5.cate1_num_30d is null, 0, t5.cate1_num_30d),
if(t5.cate2_num_30d is null, 0, t5.cate2_num_30d),
if(t5.item_num_60d is null, 0, t5.item_num_60d),
if(t5.brand_num_60d is null, 0, t5.brand_num_60d),
if(t5.seller_num_60d is null, 0, t5.seller_num_60d),
if(t5.cate1_num_60d is null, 0, t5.cate1_num_60d),
if(t5.cate2_num_60d is null, 0, t5.cate2_num_60d),
if(t5.item_num_90d is null, 0, t5.item_num_90d),
if(t5.brand_num_90d is null, 0, t5.brand_num_90d),
if(t5.seller_num_90d is null, 0, t5.seller_num_90d),
if(t5.cate1_num_90d is null, 0, t5.cate1_num_90d),
if(t5.cate2_num_90d is null, 0, t5.cate2_num_90d),

if(t6.click_num is null, 0, t6.click_num),
if(t6.collect_num is null, 0, t6.collect_num),
if(t6.cart_num is null, 0, t6.cart_num),
if(t6.alipay_num is null, 0, t6.alipay_num),

-- if(t7.clk_item_90d is null, 0, t7.clk_item_90d),
-- if(t7.clk_item_60d is null, 0, t7.clk_item_60d),
-- if(t7.clk_item_30d is null, 0, t7.clk_item_30d),
-- if(t7.clk_item_15d is null, 0, t7.clk_item_15d),
-- if(t7.clk_item_7d is null, 0, t7.clk_item_7d),
-- if(t7.clk_item_3d is null, 0, t7.clk_item_3d),
-- if(t7.clk_item_1d is null, 0, t7.clk_item_1d),
-- if(t7.clk_num_90d is null, 0, t7.clk_num_90d),
-- if(t7.clk_num_60d is null, 0, t7.clk_num_60d),
-- if(t7.clk_num_30d is null, 0, t7.clk_num_30d),
-- if(t7.clk_num_15d is null, 0, t7.clk_num_15d),
-- if(t7.clk_num_7d is null, 0, t7.clk_num_7d),
-- if(t7.clk_num_3d is null, 0, t7.clk_num_3d),
-- if(t7.clk_num_1d is null, 0, t7.clk_num_1d),
-- if(t7.clk_day_90d is null, 0, t7.clk_day_90d),
-- if(t7.clk_day_60d is null, 0, t7.clk_day_60d),
-- if(t7.clk_day_30d is null, 0, t7.clk_day_30d),
-- if(t7.clk_day_15d is null, 0, t7.clk_day_15d),
-- if(t7.clk_day_7d is null, 0, t7.clk_day_7d),
-- if(t7.clk_day_3d is null, 0, t7.clk_day_3d),
-- if(t7.clk_day_1d is null, 0, t7.clk_day_1d),
-- if(t7.clt_item_90d is null, 0, t7.clt_item_90d),
-- if(t7.clt_item_60d is null, 0, t7.clt_item_60d),
-- if(t7.clt_item_30d is null, 0, t7.clt_item_30d),
-- if(t7.clt_item_15d is null, 0, t7.clt_item_15d),
-- if(t7.clt_item_7d is null, 0, t7.clt_item_7d),
-- if(t7.clt_item_3d is null, 0, t7.clt_item_3d),
-- if(t7.clt_item_1d is null, 0, t7.clt_item_1d),
-- if(t7.cart_item_90d is null, 0, t7.cart_item_90d),
-- if(t7.cart_item_60d is null, 0, t7.cart_item_60d),
-- if(t7.cart_item_30d is null, 0, t7.cart_item_30d),
-- if(t7.cart_item_15d is null, 0, t7.cart_item_15d),
-- if(t7.cart_item_7d is null, 0, t7.cart_item_7d),
-- if(t7.cart_item_3d is null, 0, t7.cart_item_3d),
-- if(t7.cart_item_1d is null, 0, t7.cart_item_1d),
-- if(t7.cart_num_90d is null, 0, t7.cart_num_90d),
-- if(t7.cart_num_60d is null, 0, t7.cart_num_60d),
-- if(t7.cart_num_30d is null, 0, t7.cart_num_30d),
-- if(t7.cart_num_15d is null, 0, t7.cart_num_15d),
-- if(t7.cart_num_7d is null, 0, t7.cart_num_7d),
-- if(t7.cart_num_3d is null, 0, t7.cart_num_3d),
-- if(t7.cart_num_1d is null, 0, t7.cart_num_1d),
-- if(t7.pay_item_90d is null, 0, t7.pay_item_90d),
-- if(t7.pay_item_60d is null, 0, t7.pay_item_60d),
-- if(t7.pay_item_30d is null, 0, t7.pay_item_30d),
-- if(t7.pay_item_15d is null, 0, t7.pay_item_15d),
-- if(t7.pay_item_7d is null, 0, t7.pay_item_7d),
-- if(t7.pay_item_3d is null, 0, t7.pay_item_3d),
-- if(t7.pay_item_1d is null, 0, t7.pay_item_1d),
-- if(t7.pay_num_90d is null, 0, t7.pay_num_90d),
-- if(t7.pay_num_60d is null, 0, t7.pay_num_60d),
-- if(t7.pay_num_30d is null, 0, t7.pay_num_30d),
-- if(t7.pay_num_15d is null, 0, t7.pay_num_15d),
-- if(t7.pay_num_7d is null, 0, t7.pay_num_7d),
-- if(t7.pay_num_3d is null, 0, t7.pay_num_3d),
-- if(t7.pay_num_1d is null, 0, t7.pay_num_1d),

if(t8.clk_item_90d is null, 0, t8.clk_item_90d),
if(t8.clk_item_60d is null, 0, t8.clk_item_60d),
if(t8.clk_item_30d is null, 0, t8.clk_item_30d),
if(t8.clk_item_15d is null, 0, t8.clk_item_15d),
if(t8.clk_item_7d is null, 0, t8.clk_item_7d),
if(t8.clk_item_3d is null, 0, t8.clk_item_3d),
if(t8.clk_item_1d is null, 0, t8.clk_item_1d),
if(t8.clk_num_90d is null, 0, t8.clk_num_90d),
if(t8.clk_num_60d is null, 0, t8.clk_num_60d),
if(t8.clk_num_30d is null, 0, t8.clk_num_30d),
if(t8.clk_num_15d is null, 0, t8.clk_num_15d),
if(t8.clk_num_7d is null, 0, t8.clk_num_7d),
if(t8.clk_num_3d is null, 0, t8.clk_num_3d),
if(t8.clk_num_1d is null, 0, t8.clk_num_1d),
if(t8.clk_day_90d is null, 0, t8.clk_day_90d),
if(t8.clk_day_60d is null, 0, t8.clk_day_60d),
if(t8.clk_day_30d is null, 0, t8.clk_day_30d),
if(t8.clk_day_15d is null, 0, t8.clk_day_15d),
if(t8.clk_day_7d is null, 0, t8.clk_day_7d),
if(t8.clk_day_3d is null, 0, t8.clk_day_3d),
if(t8.clk_day_1d is null, 0, t8.clk_day_1d),
if(t8.clt_item_90d is null, 0, t8.clt_item_90d),
if(t8.clt_item_60d is null, 0, t8.clt_item_60d),
if(t8.clt_item_30d is null, 0, t8.clt_item_30d),
if(t8.clt_item_15d is null, 0, t8.clt_item_15d),
if(t8.clt_item_7d is null, 0, t8.clt_item_7d),
if(t8.clt_item_3d is null, 0, t8.clt_item_3d),
if(t8.clt_item_1d is null, 0, t8.clt_item_1d),
if(t8.cart_item_90d is null, 0, t8.cart_item_90d),
if(t8.cart_item_60d is null, 0, t8.cart_item_60d),
if(t8.cart_item_30d is null, 0, t8.cart_item_30d),
if(t8.cart_item_15d is null, 0, t8.cart_item_15d),
if(t8.cart_item_7d is null, 0, t8.cart_item_7d),
if(t8.cart_item_3d is null, 0, t8.cart_item_3d),
if(t8.cart_item_1d is null, 0, t8.cart_item_1d),
if(t8.cart_num_90d is null, 0, t8.cart_num_90d),
if(t8.cart_num_60d is null, 0, t8.cart_num_60d),
if(t8.cart_num_30d is null, 0, t8.cart_num_30d),
if(t8.cart_num_15d is null, 0, t8.cart_num_15d),
if(t8.cart_num_7d is null, 0, t8.cart_num_7d),
if(t8.cart_num_3d is null, 0, t8.cart_num_3d),
if(t8.cart_num_1d is null, 0, t8.cart_num_1d),
if(t8.pay_item_90d is null, 0, t8.pay_item_90d),
if(t8.pay_item_60d is null, 0, t8.pay_item_60d),
if(t8.pay_item_30d is null, 0, t8.pay_item_30d),
if(t8.pay_item_15d is null, 0, t8.pay_item_15d),
if(t8.pay_item_7d is null, 0, t8.pay_item_7d),
if(t8.pay_item_3d is null, 0, t8.pay_item_3d),
if(t8.pay_item_1d is null, 0, t8.pay_item_1d),
if(t8.pay_num_90d is null, 0, t8.pay_num_90d),
if(t8.pay_num_60d is null, 0, t8.pay_num_60d),
if(t8.pay_num_30d is null, 0, t8.pay_num_30d),
if(t8.pay_num_15d is null, 0, t8.pay_num_15d),
if(t8.pay_num_7d is null, 0, t8.pay_num_7d),
if(t8.pay_num_3d is null, 0, t8.pay_num_3d),
if(t8.pay_num_1d is null, 0, t8.pay_num_1d),

if(t9.clk_item_90d is null, 0, t9.clk_item_90d),
if(t9.clk_item_60d is null, 0, t9.clk_item_60d),
if(t9.clk_item_30d is null, 0, t9.clk_item_30d),
if(t9.clk_item_15d is null, 0, t9.clk_item_15d),
if(t9.clk_item_7d is null, 0, t9.clk_item_7d),
if(t9.clk_item_3d is null, 0, t9.clk_item_3d),
if(t9.clk_item_1d is null, 0, t9.clk_item_1d),
if(t9.clk_num_90d is null, 0, t9.clk_num_90d),
if(t9.clk_num_60d is null, 0, t9.clk_num_60d),
if(t9.clk_num_30d is null, 0, t9.clk_num_30d),
if(t9.clk_num_15d is null, 0, t9.clk_num_15d),
if(t9.clk_num_7d is null, 0, t9.clk_num_7d),
if(t9.clk_num_3d is null, 0, t9.clk_num_3d),
if(t9.clk_num_1d is null, 0, t9.clk_num_1d),
if(t9.clk_day_90d is null, 0, t9.clk_day_90d),
if(t9.clk_day_60d is null, 0, t9.clk_day_60d),
if(t9.clk_day_30d is null, 0, t9.clk_day_30d),
if(t9.clk_day_15d is null, 0, t9.clk_day_15d),
if(t9.clk_day_7d is null, 0, t9.clk_day_7d),
if(t9.clk_day_3d is null, 0, t9.clk_day_3d),
if(t9.clk_day_1d is null, 0, t9.clk_day_1d),
if(t9.clt_item_90d is null, 0, t9.clt_item_90d),
if(t9.clt_item_60d is null, 0, t9.clt_item_60d),
if(t9.clt_item_30d is null, 0, t9.clt_item_30d),
if(t9.clt_item_15d is null, 0, t9.clt_item_15d),
if(t9.clt_item_7d is null, 0, t9.clt_item_7d),
if(t9.clt_item_3d is null, 0, t9.clt_item_3d),
if(t9.clt_item_1d is null, 0, t9.clt_item_1d),
if(t9.cart_item_90d is null, 0, t9.cart_item_90d),
if(t9.cart_item_60d is null, 0, t9.cart_item_60d),
if(t9.cart_item_30d is null, 0, t9.cart_item_30d),
if(t9.cart_item_15d is null, 0, t9.cart_item_15d),
if(t9.cart_item_7d is null, 0, t9.cart_item_7d),
if(t9.cart_item_3d is null, 0, t9.cart_item_3d),
if(t9.cart_item_1d is null, 0, t9.cart_item_1d),
if(t9.cart_num_90d is null, 0, t9.cart_num_90d),
if(t9.cart_num_60d is null, 0, t9.cart_num_60d),
if(t9.cart_num_30d is null, 0, t9.cart_num_30d),
if(t9.cart_num_15d is null, 0, t9.cart_num_15d),
if(t9.cart_num_7d is null, 0, t9.cart_num_7d),
if(t9.cart_num_3d is null, 0, t9.cart_num_3d),
if(t9.cart_num_1d is null, 0, t9.cart_num_1d),
if(t9.pay_item_90d is null, 0, t9.pay_item_90d),
if(t9.pay_item_60d is null, 0, t9.pay_item_60d),
if(t9.pay_item_30d is null, 0, t9.pay_item_30d),
if(t9.pay_item_15d is null, 0, t9.pay_item_15d),
if(t9.pay_item_7d is null, 0, t9.pay_item_7d),
if(t9.pay_item_3d is null, 0, t9.pay_item_3d),
if(t9.pay_item_1d is null, 0, t9.pay_item_1d),
if(t9.pay_num_90d is null, 0, t9.pay_num_90d),
if(t9.pay_num_60d is null, 0, t9.pay_num_60d),
if(t9.pay_num_30d is null, 0, t9.pay_num_30d),
if(t9.pay_num_15d is null, 0, t9.pay_num_15d),
if(t9.pay_num_7d is null, 0, t9.pay_num_7d),
if(t9.pay_num_3d is null, 0, t9.pay_num_3d),
if(t9.pay_num_1d is null, 0, t9.pay_num_1d)
from (
    select user_id , brand_id, label, ds
    from user_pay_sample
    where ds=${bizdate}
)t1 left join (
    select *
    from user_click_beh_feature_ads
    where ds=${bizdate}
)t2 on t1.user_id=t2.user_id and t1.ds=t2.ds
left join (
    select *
    from user_collect_beh_feature_ads
    where ds=${bizdate}
)t3 on t1.user_id=t3.user_id and t1.ds=t3.ds
left join (
    select *
    from user_cart_beh_feature_ads
    where ds=${bizdate}
)t4 on t1.user_id=t4.user_id and t1.ds=t4.ds
left join (
    select *
    from user_alipay_beh_feature_ads
    where ds=${bizdate}
)t5 on t1.user_id=t5.user_id and t1.ds=t5.ds
left join (
    select *
    from brand_stat_feature_ads
    where ds=${bizdate}
)t6 on t1.brand_id=t6.brand_id and t1.ds=t6.ds
-- left join (
--     select *
--     from user_brand_cate1_cross_beh_feature_ads
--     where ds=${bizdate}
-- )t7 on t1.user_id=t7.user_id and t1.brand_id=t7.brand_id and t1.ds=t7.ds
left join (
    select *
    from user_brand_cate2_cross_beh_feature_ads
    where ds=${bizdate}
)t8 on t1.user_id=t8.user_id and t1.brand_id=t8.brand_id and t1.ds=t8.ds
left join (
    select *
    from user_brand_cross_beh_feature_ads
    where ds=${bizdate}
)t9 on t1.user_id=t9.user_id and t1.brand_id=t9.brand_id and t1.ds=t9.ds
where (t2.cnt_days_90d is not null or t2.cate1_num_90d is not null or t3.item_num_90d is not null
    or t4.item_num_90d is not null or t5.item_num_90d is not null --or t7.clk_item_90d is not null
    or t8.clk_item_90d is not null or t9.clk_item_90d is not null)
;